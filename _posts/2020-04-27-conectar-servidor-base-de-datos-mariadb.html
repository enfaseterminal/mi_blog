---
layout: post
title: Conectar a servidor base de datos MariaDB
date: '2020-04-27T19:46:00.002+02:00'
author: David P.
tags:
- mysql
- localhost
- phpmyadmin
- ssl
- servidor
- ufw
- root
- sql
- GNU/Linux
- windows
- linux
- apache
- cortafuegos
- mariadb
- nano
- raspberry
- php
modified_time: '2022-02-26T21:30:09.202+01:00'
thumbnail: https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj1yzxzzPpeRNF0Yw97AQelJ8AVcatQIp_G1rqUDS5INBOKP15eCJfnOt81pVDovN2q4ttJGk13ROHStTI4ssctq5TcH_X6GNugg88tN7qz2S1MktZHerFIVk2gY_zwbIZ8QWjQzDriwiQ/s72-w200-c-h103/MariaDB_Logo.d8a208f0a889a8f0f0551b8391a065ea79c54f3a.png
blogger_id: tag:blogger.com,1999:blog-3624480011084378437.post-1221306183045362606
blogger_orig_url: https://www.enfaseterminal.com/2020/04/conectar-servidor-base-de-datos-mariadb.html
---

Puede ser el caso que además de gestionar una base de datos SQL en local, necesitamos gestionarla en remoto. En la mayoría de los servidores de hospedaje web, no nos permiten conectarnos a la servidor de base de datos en remoto, tenemos que hacerlo en local. Una de las herramientas más utilizadas es <a href="https://www.phpmyadmin.net/" target="_blank">PhpMyAdmin</a>. Este caso en concreto he instalado un servidor de base de datos <a href="https://mariadb.org/" target="_blank">MariaDB</a> Server en una Raspberry. Tengo muy oxidado el lenguaje <a href="https://es.wikipedia.org/wiki/SQL" target="_blank">SQL</a> como para acceder al servidor a través de SSL y realizar todas las tareas de instalación de rablas y mantenimiento desde el cliente de MariaDB. Quiero gestionarla en un entorno más amigable, pero no quiero instalar a mayores un servidor <a href="https://es.wikipedia.org/wiki/Servidor_HTTP_Apache" target="_blank">Apache</a> con <a href="https://es.wikipedia.org/wiki/PHP" target="_blank">PHP</a> para poder utilizar PhpMyAdmin.<div><br /></div><div><blockquote><a href="https://es.wikipedia.org/wiki/MariaDB" target="_blank"></a><div class="separator" style="clear: both; text-align: center;"><a href="https://es.wikipedia.org/wiki/MariaDB" target="_blank"></a><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj1yzxzzPpeRNF0Yw97AQelJ8AVcatQIp_G1rqUDS5INBOKP15eCJfnOt81pVDovN2q4ttJGk13ROHStTI4ssctq5TcH_X6GNugg88tN7qz2S1MktZHerFIVk2gY_zwbIZ8QWjQzDriwiQ//" style="margin-left: 1em; margin-right: 1em;"><img alt="Logo MariaDB" border="0" data-original-height="175" data-original-width="340" height="103" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj1yzxzzPpeRNF0Yw97AQelJ8AVcatQIp_G1rqUDS5INBOKP15eCJfnOt81pVDovN2q4ttJGk13ROHStTI4ssctq5TcH_X6GNugg88tN7qz2S1MktZHerFIVk2gY_zwbIZ8QWjQzDriwiQ/w200-h103/MariaDB_Logo.d8a208f0a889a8f0f0551b8391a065ea79c54f3a.png" title="Logo MariaDB" width="200" /></a><span style="text-align: left;">MariaDB&nbsp; es un sistema de gestión de bases de datos derivado de MySQL con licencia GPL (General Public License). Es desarrollado por Michael (Monty) Widenius —fundador de MySQL—, la fundación MariaDB y la comunidad de desarrolladores de software libre.1​ Introduce dos motores de almacenamiento nuevos, uno llamado Aria —que reemplaza a MyISAM— y otro llamado XtraDB —en sustitución de InnoDB—. Tiene una alta compatibilidad con MySQL ya que posee las mismas órdenes, interfaces, API y bibliotecas, siendo su objetivo poder cambiar un servidor por otro directamente.</span></div></blockquote><blockquote><div style="text-align: right;"><a href="https://es.wikipedia.org/wiki/MariaDB" target="_blank">Wikipedia</a>&nbsp;</div></blockquote><div>Aunque el tutorial es para MariaDB, este puede ser extensible si así fuera un servidor de MySQL.</div><div><br /></div><div>De forma predeterminada y por seguridad no permiten el acceso remoto, solo se permite acceso atraves de localhost.</div><div><br /></div><div><a href="https://www.enfaseterminal.com/2020/04/instalar-servidor-base-de-datos-mariadb.html" target="_blank">Una vez instalada el servidor y el cliente en nuestra distribución</a>. Aseguramos la instalación lanzando el comando:</div><div><br /></div></div><blockquote style="border: none; margin: 0px 0px 0px 40px; padding: 0px;"><div><div style="text-align: left;">sudo mysql_secure_installation&nbsp;</div></div></blockquote><div><div><br /></div></div><div><div style="text-align: center;"><table border="1" bordercolor="#888" cellspacing="0" style="border-collapse: collapse; border-color: rgb(136, 136, 136); border-width: 1px; text-align: justify;"><tbody><tr><td style="text-align: justify;"><blockquote style="border: none; margin: 0 0 0 40px; padding: 0px;"><blockquote style="border: none; margin: 0 0 0 40px; padding: 0px;">Enter current password for root (enter for none): Pulsa enter</blockquote></blockquote></td><td style="text-align: justify;"><blockquote style="border: none; margin: 0 0 0 40px; padding: 0px;"><blockquote style="border: none; margin: 0 0 0 40px; padding: 0px;">&nbsp;Introduzca la contraseña actual para root (ingrese para none): Pulse Enter</blockquote></blockquote></td></tr><tr><td style="text-align: justify;"><blockquote style="border: none; margin: 0 0 0 40px; padding: 0px;"><blockquote style="border: none; margin: 0 0 0 40px; padding: 0px;">&nbsp;Set root password? [Y/n]: Y</blockquote></blockquote></td><td style="text-align: justify;"><blockquote style="border: none; margin: 0 0 0 40px; padding: 0px;"><blockquote style="border: none; margin: 0 0 0 40px; padding: 0px;">&nbsp;¿Establecer contraseña del root? [Y/n]: Y</blockquote></blockquote></td></tr><tr><td style="text-align: justify;"><blockquote style="border: none; margin: 0 0 0 40px; padding: 0px;"><blockquote style="border: none; margin: 0 0 0 40px; padding: 0px;">&nbsp;New password: Enter password</blockquote></blockquote></td><td style="text-align: justify;"><blockquote style="border: none; margin: 0 0 0 40px; padding: 0px;"><blockquote style="border: none; margin: 0 0 0 40px; padding: 0px;">&nbsp;Nueva contraseña: Introduzca contraseña</blockquote></blockquote></td></tr><tr><td style="text-align: justify; width: 60px;"><blockquote style="border: none; margin: 0 0 0 40px; padding: 0px;"><blockquote style="border: none; margin: 0 0 0 40px; padding: 0px;">&nbsp;Re-enter new password: Repeat password</blockquote></blockquote></td><td style="text-align: justify; width: 60px;"><blockquote style="border: none; margin: 0 0 0 40px; padding: 0px;"><blockquote style="border: none; margin: 0 0 0 40px; padding: 0px;">&nbsp;Reescribir nueva contraseña: Repetir contraseña</blockquote></blockquote></td></tr><tr><td style="text-align: justify;"><blockquote style="border: none; margin: 0 0 0 40px; padding: 0px;"><blockquote style="border: none; margin: 0 0 0 40px; padding: 0px;">&nbsp;Remove anonymous users? [Y/n]: Y</blockquote></blockquote></td><td style="text-align: justify;"><blockquote style="border: none; margin: 0 0 0 40px; padding: 0px;"><blockquote style="border: none; margin: 0 0 0 40px; padding: 0px;">¿ Borrar usuarios anónimos? [Y/n]: Y</blockquote></blockquote></td></tr><tr><td style="text-align: justify;"><blockquote style="border: none; margin: 0 0 0 40px; padding: 0px;"><blockquote style="border: none; margin: 0 0 0 40px; padding: 0px;">&nbsp;Disallow root login remotely? [Y/n]: Y</blockquote></blockquote></td><td style="text-align: justify;"><blockquote style="border: none; margin: 0 0 0 40px; padding: 0px;"><blockquote style="border: none; margin: 0 0 0 40px; padding: 0px;">¿No permitir el acceso al root desde remoto? [Y/n]: Y</blockquote></blockquote></td></tr><tr><td style="text-align: justify;"><blockquote style="border: none; margin: 0 0 0 40px; padding: 0px;"><blockquote style="border: none; margin: 0 0 0 40px; padding: 0px;">&nbsp;Remove test database and access to it? [Y/n]:&nbsp; Y</blockquote></blockquote></td><td style="text-align: justify;"><blockquote style="border: none; margin: 0 0 0 40px; padding: 0px;"><blockquote style="border: none; margin: 0 0 0 40px; padding: 0px;">&nbsp;¿Borrar Bases de datos Test y su acceso? [Y/n]: Y</blockquote></blockquote></td></tr><tr><td style="text-align: justify; width: 60px;"><blockquote style="border: none; margin: 0 0 0 40px; padding: 0px;"><blockquote style="border: none; margin: 0 0 0 40px; padding: 0px;">&nbsp;Reload privilege tables now? [Y/n]:&nbsp; Y</blockquote></blockquote></td><td style="text-align: justify; width: 60px;"><blockquote style="border: none; margin: 0 0 0 40px; padding: 0px;"><blockquote style="border: none; margin: 0 0 0 40px; padding: 0px;">&nbsp;¿Recargar privilegios a las tablas ahora? [Y/n]: Y</blockquote></blockquote></td></tr></tbody></table><div style="text-align: justify;"><br /></div></div><div style="text-align: justify;">No vamos a permitir al root acceder desde remoto, no es considerado de una buena praxis de seguridad que el administrador se pueda conectar en remoto. Por el contrario vamos a crear un usuario nuevo y le vamos a dar privilegios de acceso desde remoto. En este caso indicaremos que el usuario se puede conectar desde cualquier equipo de nuestra LAN. Con 192.168.100 indicamos que subred se puede conectar usando el carácter % como comodín para indicarle que cualquier equipo de esta. También podríamos limitar aun más indicando la dirección ip del equipo desde el que únicamente puede acceder en remoto. Creando un entorno aun más seguro</div><div style="text-align: justify;"><span style="text-align: left;"><br /></span></div></div><blockquote style="border: none; margin: 0px 0px 0px 40px; padding: 0px;"><div><div style="text-align: justify;"><span style="text-align: left;">CREATE USER&nbsp;</span>'<b>nuevo usuario</b>'@'192.168.100.%'<span style="text-align: left;">;</span></div></div></blockquote><div><div style="text-align: justify;"><span style="text-align: left;">&nbsp;</span></div></div><blockquote style="border: none; margin: 0px 0px 0px 40px; padding: 0px;"><div style="text-align: justify;"><div>GRANT ALL PRIVILEGES ON *.* TO '<b>nuevo usuario</b>'@'192.168.100.%' IDENTIFIED BY '<b>nueva contraseña</b>' WITH GRANT OPTION;</div></div></blockquote><div><br /></div><div>Seguidamente configuraremos de forma manual, no solo el acceso en local, si no el acceso en remoto.</div><div>Deberemos localizar los archivos de configuración de MySQL o de MariaDB.</div><div><ul style="text-align: left;"><li>/etc/my.cnf&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</li><li>$MYSQL_HOME/my.cnf</li><li><b>/etc/mysql/my.cnf&nbsp; &nbsp; </b>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</li><li>SYSCONFDIR/my.cnf&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</li><li>DATADIR\my.ini&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<b>Windows</b></li></ul><div>Editando el archivo de configuración <b>/etc/mysql/my.cnf</b></div></div><div><br /></div><div><blockquote style="border: none; margin: 0px 0px 0px 40px; padding: 0px;"><div style="text-align: left;">sudo nano /etc/mysql/my.cnf</div></blockquote><div>&nbsp;</div></div><div><br /></div><div><blockquote style="border: none; margin: 0px 0px 0px 40px; padding: 0px;"><div style="text-align: left;"><div># The MariaDB configuration file</div><div>#</div><div># The MariaDB/MySQL tools read configuration files in the following order:</div><div># 1. "/etc/mysql/mariadb.cnf" (this file) to set global defaults,</div><div># 2. "/etc/mysql/conf.d/*.cnf" to set global options.</div><div># 3. "/etc/mysql/mariadb.conf.d/*.cnf" to set MariaDB-only options.</div><div># 4. "~/.my.cnf" to set user-specific options.</div><div>#</div><div># If the same option is defined multiple times, the last one will apply.</div><div>#</div><div># One can use all long options that the program supports.</div><div># Run program with --help to get a list of available options and with</div><div># --print-defaults to see which it would actually understand and use.</div><div><br /></div><div>#</div><div># This group is read both both by the client and the server</div><div># use it for options that affect everything</div><div>#</div><div>[client-server]</div><div><br /></div><div># Import all .cnf files from configuration directory</div><div>!includedir <b>/etc/mysql/conf.d/</b></div><div>!includedir /etc/mysql/mariadb.conf.d/</div></div></blockquote><div><br /></div><div>Nos indica los directorios donde se encuetra el archivo que estamos buscando para editarlo. <b>50-server.cnf</b></div></div><div><br /></div><div><blockquote style="border: none; margin: 0px 0px 0px 40px; padding: 0px;"><div style="text-align: left;">sudo nano <b>/etc/mysql/mariadb.conf.d/50-server.cnf</b></div></blockquote><div><br /></div><div>Buscaremos la sección [mysqld]&nbsp; donde editaremos los valores que nos permitan conexiones externas. Este es un ejemplo real de configuración que me ha permitido conectarme al servidor desde otro equipo.</div><div><br /></div></div><blockquote style="border: none; margin: 0px 0px 0px 40px; padding: 0px;"><div><div style="text-align: left;"><div><b>[mysqld]</b></div><div><br /></div><div>#</div><div># * Basic Settings</div><div>#</div><div>user&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = mysql</div><div>pid-file&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = /run/mysqld/mysqld.pid</div><div>socket&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = /run/mysqld/mysqld.sock</div><div><b>port&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 3306</b></div><div>basedir&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= /usr</div><div>datadir&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= /var/lib/mysql</div><div>tmpdir&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = /tmp</div><div>lc-messages-dir&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= /usr/share/mysql</div><div><b>#skip-external-locking</b></div><div><br /></div><div># Instead of skip-networking the default is now to listen only on</div><div># localhost which is more compatible and is not less secure.</div><div><b>#bind-address&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 127.0.0.1</b></div><div><b>bind-address&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0.0.0.0</b></div></div></div></blockquote><div><br /></div><blockquote style="border: none; margin: 0px 0px 0px 40px; padding: 0px;"><div style="text-align: left;">.......................................................</div></blockquote><div><br /></div><blockquote style="border: none; margin: 0px 0px 0px 40px; padding: 0px;"><div style="text-align: left;">&nbsp;# * Security Features</div><div>#</div><div># Read the manual, too, if you want chroot!</div><div>#chroot = /var/lib/mysql/</div><div>#</div><div># For generating SSL certificates you can use for example the GUI tool "tinyca".</div><div>#</div><div>#ssl-ca = /etc/mysql/cacert.pem</div><div>#ssl-cert = /etc/mysql/server-cert.pem</div><div>#ssl-key = /etc/mysql/server-key.pem</div><div>#</div><div># Accept only connections using the latest and most secure TLS protocol version.</div><div># ..when MariaDB is compiled with OpenSSL:</div><div><b>ssl-cipher = TLSv1.2</b></div><div># ..when MariaDB is compiled with YaSSL (default in Debian):</div><div><b>#ssl = on</b></div></blockquote><div><br /></div><div>Te explico de forma más detallada las lineas a editar para un correcto funcionamiento.&nbsp;</div><div><br /></div><div><ul style="text-align: left;"><li>&nbsp;<b>port&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 3306 </b>Es el puerto por defecto, no es necesario cambiarlo, pero si fuera necesario podríamos especificar otro puerto de accesos.</li><li><b>#skip-external-locking </b>Comentamos esta linea para permitir que el servidor sea accesible desde el exterior. Comentamos añadiendo el carácter <b>#</b></li><li><b style="font-weight: bold;">#bind-address&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 127.0.0.1 </b>Tambien aañadimso el caracter <b># </b>para comentar esta linea.</li><li><b>bind-address&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0.0.0.0 </b>Añadiremos una linea con los parametros indicados.</li><li><b>ssl-cipher = TLSv1.2 </b>Esta parte hay que tenerla en cuenta si tenemos problemas a la hora de concetar con los certificados. Al utilizar OpenSSL descomentamos esta linea</li><li><b>#ssl = on </b>Y comentamos esta otra. Que era la que estaba activa de forma predeterminada pero, que en mi caso no me permitía conectarme.</li></ul><div>Una vez modificado las lineas señalas. Guardamos y salimos del editor de textos. Y reiniciamos el servicio.</div></div><div><br /></div><blockquote style="border: none; margin: 0px 0px 0px 40px; padding: 0px;"><div style="text-align: left;">sudo systemctl restart mariadb.service</div></blockquote><div><br /></div><div>Tenemos que tener en cuenta, si en nuestro servidor, tenemos instalado y corriendo un cortafuegos, debemos permitir las conexiones a través del puerto <b>3306, </b>si lo hemos dejado por defecto, o el puerto que asignemos al servicio. Para añadir el permiso abrir el mencionado puerto utlizando <a href="https://www.enfaseterminal.com/search/label/ufw">ufw</a> seria:</div><div><br /></div><div><blockquote style="border: none; margin: 0px 0px 0px 40px; padding: 0px;"><div style="text-align: left;">sudo ufw allow 3306/tcp</div></blockquote><div><br /></div><div>Y si solo vamos a permitir el acceso en remoto a un equipo, con una dirección ip en concreto:</div><div><br /></div></div><blockquote style="border: none; margin: 0px 0px 0px 40px; padding: 0px;"><div><div style="text-align: left;">&nbsp;sudo ufw allow from 192.168.100.2 to any port 3306</div></div></blockquote>